<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Key Access Site</title>
<style>
  body { font-family: Arial, sans-serif; background: #121212; color: #eee; text-align: center; padding: 2rem; }
  #ipLoggerTab { display: none; margin-top: 2rem; background: #222; padding: 1rem; border-radius: 8px; max-width: 600px; margin-left: auto; margin-right: auto; }
  #accessForm input[type="text"] { padding: 0.5rem; font-size: 1rem; }
  #accessForm button { padding: 0.5rem 1rem; font-size: 1rem; margin-left: 0.5rem; }
  textarea { width: 100%; height: 200px; background: #111; color: #0f0; padding: 1rem; border-radius: 5px; font-family: monospace; resize: none; }
</style>
</head>
<body>

<h1>Enter Access Key</h1>
<form id="accessForm" onsubmit="return false;">
  <input type="text" id="keyInput" placeholder="Enter key here" autocomplete="off" />
  <button onclick="checkKey()">Submit</button>
</form>

<div id="ipLoggerTab">
  <h2>IP Logger Tab (Authorized Access)</h2>
  <textarea id="ipLogBox" readonly></textarea>
</div>

<script>
const correctKey = "LEGLEGLEGLEGLEG";
const ipLogBox = document.getElementById('ipLogBox');
const ipLoggerTab = document.getElementById('ipLoggerTab');

function checkKey() {
  const inputKey = document.getElementById('keyInput').value.trim();
  if (inputKey === correctKey) {
    alert("Access Granted!");
    showIPLoggerTab();
  } else {
    alert("Access Denied! Your IP will be logged.");
    logIPAndHostname();
  }
}

// Show the IP Logger tab (only after correct key)
function showIPLoggerTab() {
  ipLoggerTab.style.display = 'block';
  ipLogBox.value = "Welcome LEG! No IPs logged yet.";
}

// Log IP and Hostname for wrong keys
async function logIPAndHostname() {
  try {
    // Get public IP via ipify API (free, no auth)
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    const ip = data.ip;

    // Hostname is NOT accessible via browser. We will just mark "Unknown Hostname"
    const hostname = "Unknown Hostname (not accessible from browser)";

    // Display IP and hostname in ipLogBox - here for demo (this would be your own log on your end)
    ipLogBox.value += `\nBlocked Access Attempt - IP: ${ip} - Hostname: ${hostname}`;

    // Show IP Logger tab (simulate your view)
    ipLoggerTab.style.display = 'block';

    // Here, you could send the IP and hostname to your own backend API for storage:
    // await fetch('https://your-backend.com/log-ip', {
    //   method: 'POST',
    //   headers: { 'Content-Type': 'application/json' },
    //   body: JSON.stringify({ ip, hostname, time: new Date().toISOString() })
    // });

  } catch (e) {
    console.error("Failed to get IP", e);
  }
}
</script>

</body>
</html>
